<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OPSD — Descarga videos de TikTok sin marca de agua</title>
    <meta name="description" content="OPSD te permite descargar videos de TikTok sin marca de agua. Disponible para Android. Creado por Quarkl Cloud." />
    <meta name="theme-color" content="#0b1220" />
    <meta property="og:title" content="OPSD — TikTok sin marca de agua (Android)" />
    <meta property="og:description" content="Descarga videos de TikTok sin marca de agua. APK listo para Android." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://raw.githubusercontent.com/edent/SuperTinyIcons/master/images/svg/tiktok.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="./favicon.svg" />
    <link rel="stylesheet" href="./style.css" />
    <!-- Google AdSense: verificación y Auto Ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5944264134562590" crossorigin="anonymous"></script>
    <!-- Monetag MultiTag (todo en uno) -->
    <!-- Nota: lo cargamos on-demand al hacer clic para evitar auto-run en load -->
  </head>
  <body>
    <header class="site-header">
      <div class="container header-inner">
        <div class="brand">
          <span class="logo">OPSD</span>
          <span class="tag">by Quarkl Cloud</span>
        </div>
        <nav class="nav">
          <a href="#descargar" class="btn btn-primary">Descargar APK</a>
          <a href="#features">Características</a>
          <a href="#how">Instalación</a>
          <a href="#support">Apóyanos</a>
          <a href="#faq">FAQ</a>
        </nav>
      </div>
    </header>

    <main>
      <!-- Ad slot: top banner -->
      <div class="ad-slot ad-top" aria-label="Publicidad">
        <!-- Monetag can auto-fill via Tag script -->
      </div>
      <section class="hero">
        <div class="container hero-inner">
          <h1>Descarga videos de TikTok sin marca de agua</h1>
          <p class="subtitle">La forma más sencilla y rápida. Versión Android disponible.</p>
          <div class="cta" id="descargar">
            <a class="btn btn-primary btn-lg" href="https://github.com/QuarkLCloudKids/ospd/releases/download/DESCARGAR/opsd.apk" target="_self" rel="noopener" id="download-main">
              Descargar OPSD (APK)
            </a>
            <p class="cta-note">La descarga inicia automáticamente en una nueva pestaña.</p>
          </div>
          <!-- Ad slot: hero inline banner -->
          <div class="ad-slot ad-hero" aria-label="Publicidad"></div>
          <div class="hero-media">
            <img src="https://raw.githubusercontent.com/edent/SuperTinyIcons/master/images/svg/tiktok.svg" alt="TikTok" />
          </div>
        </div>
      </section>

      <section class="features" id="features">
        <div class="container">
          <h2>¿Qué funciona hoy?</h2>
          <!-- Ad slot: features top -->
          <div class="ad-slot ad-features-top" aria-label="Publicidad"></div>
          <ul class="feature-list grid">
            <li>
              <strong>TikTok sin marca de agua</strong>
              <span>Descarga limpia del video original.</span>
            </li>
            <li>
              <strong>Rápido y sencillo</strong>
              <span>Interfaz enfocada en móvil y un solo toque.</span>
            </li>
            <li>
              <strong>APK listo</strong>
              <span>Instalación directa en Android.</span>
            </li>
          </ul>

          <h2>Próximas actualizaciones</h2>
          <!-- Ad slot: features mid -->
          <div class="ad-slot ad-features-mid" aria-label="Publicidad"></div>
          <ul class="roadmap-list grid">
            <li><strong>Instagram</strong> <span>Reels y publicaciones.</span></li>
            <li><strong>Facebook</strong> <span>Videos públicos.</span></li>
            <li><strong>YouTube</strong> <span>Integración mediante proveedores.</span></li>
          </ul>
        </div>
      </section>

      <section class="how" id="how">
        <div class="container">
          <h2>Cómo instalar</h2>
          <ol class="steps">
            <li>Descarga el archivo <strong>opsd.apk</strong> desde el botón superior.</li>
            <li>En tu Android, activa <em>Permitir apps de orígenes desconocidos</em>.</li>
            <li>Abre el APK y sigue los pasos de instalación.</li>
          </ol>
          <!-- Ad slot: how section -->
          <div class="ad-slot ad-how" aria-label="Publicidad"></div>
          <p class="disclaimer">Nota: la versión actual usa firma de debug, ideal para pruebas e instalación directa (no destinada a Play Store).</p>
        </div>
      </section>

      <section class="why" id="support">
        <div class="container">
          <h2>Por qué es gratis y cómo monetizamos</h2>
          <ul class="feature-list">
            <li><strong>Sin anuncios invasivos</strong> — nada de pop‑ups ni banners a pantalla completa.</li>
            <li><strong>Donaciones opcionales</strong> — apóyanos cuando quieras, sin bloquear funciones.</li>
            <li><strong>Patrocinios discretos</strong> — acuerdos visibles y respetuosos, sin rastreo de terceros.</li>
            <li><strong>Privacidad primero</strong> — no vendemos datos ni pedimos inicio de sesión.</li>
          </ul>
          <div class="cta">
            <a class="btn" href="#" aria-disabled="true" title="Próximamente">Donar (próximamente)</a>
            <a class="btn" href="#" aria-disabled="true" title="Próximamente">Patrocinar (próximamente)</a>
          </div>
          <!-- Ad slot: support section -->
          <div class="ad-slot ad-support" aria-label="Publicidad"></div>
        </div>
      </section>

      <section class="faq" id="faq">
        <div class="container">
          <h2>Preguntas frecuentes</h2>
          <!-- Ad slot: faq top -->
          <div class="ad-slot ad-faq-top" aria-label="Publicidad"></div>
          <div class="faq-list">
            <details>
              <summary>¿Hay versión web de la app?</summary>
              <p>No. Solo existe la versión móvil (Android) y esta web sirve para descargar el APK.</p>
            </details>
            <details>
              <summary>¿Funciona en iOS?</summary>
              <p>Por ahora no. Estamos evaluando opciones para futuras versiones.</p>
            </details>
            <details>
              <summary>¿Es legal descargar videos?</summary>
              <p>Usa la app respetando derechos de autor y términos de servicio. Descarga solo contenido que tienes permiso para usar.</p>
            </details>
            <details>
              <summary>Privacidad</summary>
              <p>No vendemos datos ni pedimos inicio de sesión. La app se centra en la descarga del video.</p>
            </details>
          </div>
          <!-- Ad slot: faq bottom -->
          <div class="ad-slot ad-faq-bottom" aria-label="Publicidad"></div>
        </div>
      </section>

      <a class="float-cta" href="https://github.com/QuarkLCloudKids/ospd/releases/download/DESCARGAR/opsd.apk" target="_self" rel="noopener" aria-label="Descargar OPSD APK" id="download-float">Descargar APK</a>
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <p>Creado por <strong>Quarkl Cloud</strong>. © <span id="year"></span></p>
        <p>Solo versión móvil (Android). No existe versión web de la app.</p>
      </div>
      <!-- Ad slot: sticky footer -->
      <div class="ad-slot ad-sticky" aria-label="Publicidad"></div>
    </footer>

    <!-- Monetag MultiTag: se cargará bajo demanda al hacer clic en Descargar -->

    <script>
      // Registrar service worker para verificación cuando sea necesario
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js', { scope: '/' })
            .catch(() => {});
        });
      }
      document.getElementById('year').textContent = new Date().getFullYear();

      // Gating por interstitial: carga bajo demanda + contador y liberación de descarga
      const DOWNLOAD_URL = 'https://github.com/QuarkLCloudKids/ospd/releases/download/DESCARGAR/opsd.apk';
      const GATE_SECONDS = 12;
      const MULTITAG_ZONE = '184442';
      let multiTagLoads = 0;
      let multiTagShows = 0;
      const MULTITAG_SHOW_LIMIT = 6; // límite de impactos por sesión

      function loadMonetagMultiTag() {
        // Cargar MultiTag solo una vez y tratar de disparar el formato de pantalla
        if (typeof window.show_184442 === 'function') {
          try { window.show_184442().catch(() => {}); } catch (_) {}
          return;
        }
        if (window.__monetagMultiTagLoaded) return;
        window.__monetagMultiTagLoaded = true;
        const s = document.createElement('script');
        s.src = 'https://fpyf8.com/88/tag.min.js';
        s.async = true;
        s.setAttribute('data-zone', MULTITAG_ZONE);
        s.setAttribute('data-cfasync', 'false');
        document.body.appendChild(s);
        // Intentar disparar si aparece API show_*
        let tries = 0;
        const iv = setInterval(() => {
          tries++;
          if (typeof window.show_184442 === 'function') {
            try { window.show_184442().catch(() => {}); } catch (_) {}
            clearInterval(iv);
          }
          if (tries > 20) clearInterval(iv);
        }, 250);
      }

      function triggerMultiTag(reason = 'generic', force = false) {
        try { localStorage.setItem('mt_reason_last', reason); } catch (_) {}
        if (!force && multiTagShows >= MULTITAG_SHOW_LIMIT) return;
        loadMonetagMultiTag();
        // Intentar mostrar si existe API
        if (typeof window.show_184442 === 'function') {
          try { window.show_184442().catch(() => {}); } catch (_) {}
        }
        multiTagShows++;
      }

      function startGateCountdown(btn) {
        let remaining = GATE_SECONDS;
        const label = document.createElement('span');
        label.className = 'countdown';
        label.style.marginLeft = '8px';
        label.textContent = `(espera ${remaining}s)`;
        btn.appendChild(label);
        btn.setAttribute('aria-disabled', 'true');
        btn.classList.add('disabled');

        const t = setInterval(() => {
          remaining--;
          label.textContent = `(espera ${remaining}s)`;
          if (remaining <= 0) {
            clearInterval(t);
            btn.removeAttribute('aria-disabled');
            btn.classList.remove('disabled');
            try { label.remove(); } catch (_) {}
            // Liberar descarga en la misma pestaña para evitar bloqueos de popup
            window.location.href = DOWNLOAD_URL;
          }
        }, 1000);
      }

      function gateDownload(e) {
        e.preventDefault();
        const btn = e.currentTarget;
        // Disparar MultiTag SOLO al hacer clic en descargar
        triggerMultiTag('download_click', true);
        startGateCountdown(btn);
      }

      const mainBtn = document.getElementById('download-main');
      const floatBtn = document.getElementById('download-float');
      if (mainBtn) mainBtn.addEventListener('click', gateDownload);
      if (floatBtn) floatBtn.addEventListener('click', gateDownload);

      // Banners/overlay adicionales: disparar MultiTag por engagement si aún no se mostró
      (function scheduleExtraMultiTag(){
        let scheduled = false;
        function showBannerOnce(){
          if (scheduled || window.__monetagMultiTagLoaded) return;
          scheduled = true;
          triggerMultiTag('engagement');
        }
        // tras 18s de permanencia
        setTimeout(showBannerOnce, 18000);
        // al llegar a ~65% del scroll
        window.addEventListener('scroll', () => {
          if (scheduled || window.__monetagMultiTagLoaded) return;
          const pos = window.scrollY + window.innerHeight;
          const total = document.body.scrollHeight;
          if (total && pos/total >= 0.65) showBannerOnce();
        }, { passive: true });
      })();

      // Más disparadores: primer scroll, clicks de navegación, exit-intent
      let firedScrollStart = false;
      window.addEventListener('scroll', () => {
        if (!firedScrollStart) {
          firedScrollStart = true;
          triggerMultiTag('scroll_start');
        }
      }, { passive: true });

      document.querySelectorAll('.nav a').forEach(a => {
        if (a.id === 'download-main') return;
        a.addEventListener('click', () => triggerMultiTag('nav_click'));
      });

      // Exit intent (solo desktop)
      if (matchMedia('(pointer:fine)').matches) {
        let exitArmed = true;
        window.addEventListener('mousemove', (e) => {
          if (!exitArmed) return;
          if (e.clientY < 12) {
            exitArmed = false;
            triggerMultiTag('exit_intent');
          }
        });
      }
    </script>
  </body>
  </html>